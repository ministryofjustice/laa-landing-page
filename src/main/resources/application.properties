# Thymeleaf 
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html
spring.thymeleaf.enabled=true
spring.thymeleaf.cache=false

# =======================================
# Entra ID (Azure AD) Configuration
# =======================================

# OAuth2 Client Configuration
spring.security.oauth2.client.registration.azure.client-id=${AZURE_CLIENT_ID}
spring.security.oauth2.client.registration.azure.client-secret=${AZURE_CLIENT_SECRET}
spring.security.oauth2.client.registration.azure.tenant-id=${AZURE_TENANT_ID}
spring.security.oauth2.client.registration.azure.scope=openid, profile, email
spring.security.oauth2.client.registration.azure.redirect-uri=${BASE_URL}/login/oauth2/code/azure
spring.security.oauth2.client.registration.azure.authorization-grant-type=authorization_code

# OAuth2 Provider Configuration
spring.security.oauth2.client.provider.azure.issuer-uri=https://login.microsoftonline.com/${AZURE_TENANT_ID}/v2.0
spring.security.oauth2.client.provider.azure.token-uri=https://login.microsoftonline.com/${AZURE_TENANT_ID}/oauth2/v2.0/token
spring.security.oauth2.client.provider.azure.user-info-uri=https://graph.microsoft.com/oidc/userinfo
spring.security.oauth2.client.provider.azure.jwk-set-uri=https://login.microsoftonline.com/${AZURE_TENANT_ID}/discovery/v2.0/keys

# Resource Server Configuration
spring.security.oauth2.resourceserver.jwt.issuer-uri=https://sts.windows.net/${AZURE_TENANT_ID}/
spring.security.oauth2.resourceserver.jwt.jwk-set-uri=https://login.microsoftonline.com/${AZURE_TENANT_ID}/discovery/v2.0/keys
spring.security.oauth2.resourceserver.jwt.audience=api://${APP_DEV_URL}/${AZURE_CLIENT_ID}

# Azure AD App Registration (for server-to-server auth)
azure.tenant-id=${AZURE_TENANT_ID}
azure.client-id=${AZURE_CLIENT_ID}
azure.client-secret=${AZURE_CLIENT_SECRET}
azure.authority=https://login.microsoftonline.com/

# Microsoft Graph API
microsoft.graph.scope=https://graph.microsoft.com/.default

# Logging
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.web=DEBUG
logging.level.org.springframework.security.oauth2.jwt=TRACE
logging.level.org.springframework.core.env.PropertySourcesPropertyResolver=DEBUG

#spring.profiles.active=dev

# Network
server.forward-headers-strategy=FRAMEWORK

# Sentry
sentry.dsn=https://d44ce4f7b634d8e905b69ceb5c180997@o345774.ingest.us.sentry.io/4509286516588544
sentry.send-default-pii=true
sentry.enabled=${SENTRY_ENABLED:true}

# Expose prometheus metrics endpoint
management.endpoints.web.exposure.include=health,prometheus

# Database
spring.datasource.url=jdbc:postgresql://${POSTGRES_DB_ADDRESS}:5432/${POSTGRES_DB_NAME}
spring.datasource.username=${POSTGRES_USERNAME}
spring.datasource.password=${POSTGRES_PASSWORD}
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=validate

# spring.datasource.url=jdbc:h2:mem./idam
# spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.H2Dialect
# spring.datasource.driver-class-name=org.h2.Driver
# spring.datasource.username=laa
# spring.datasource.password=laa
#spring.jpa.hibernate.ddl-auto=create-drop

# Email Notifications
notifications.govNotifyApiKey=${GOV_NOTIFY_API_KEY:}
notifications.addNewUserEmailTemplate=a9b2f269-e1e8-4aa2-a472-d8018073f864
notifications.portalUrl=http://localhost:8080

# LAA Landing Page Apps
app.civil.apply.name=${APP_CIVIL_APPLY_NAME:Civil Apply}
app.civil.apply.url=${APP_CIVIL_APPLY_URL:#}
app.crime.apply.name=${APP_CRIME_APPLY_NAME:Crime Apply}
app.crime.apply.url=${APP_CRIME_APPLY_URL:#}
app.pui.name=${APP_PUI_NAME:PUI}
app.pui.url=${APP_PUI_URL:#}
app.submit.crime.form.name=${APP_SUBMIT_CRIME_FORM_NAME:Submit a crime form}
app.submit.crime.form.url=${APP_SUBMIT_CRIME_FORM_URL:#}

# Application details
spring.config.import=classpath:data/laa-apps-details.yml

# entra
entra.defaultDomain = mojodevlexternal.onmicrosoft.com

# Tech Services
app.tech.services.base.url=http://localhost:8080
app.tech.services.sec.group.uri=approles

# Dummy data population
app.populate.dummy-data=${POPULATE_TEST_DATA:true}
app.test.admin.userPrincipals=${TEST_DATA_ADMIN_PRINCIPALS}
app.test.nonadmin.userPrincipals=${TEST_DATA_NON_ADMIN_PRINCIPALS}
