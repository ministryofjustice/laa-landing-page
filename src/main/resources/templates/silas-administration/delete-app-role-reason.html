<!DOCTYPE html>
<html lang="en" th:replace="~{layout :: layout(
      title=~{::title},
      mainContent=~{::#main-content},
      pageCategory=${'delete-app-role-reason'},
      breadcrumbs=~{::#breadcrumbs})}" xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Why are you changing the firm</title>
</head>

<body>
    <nav aria-label="Breadcrumb" class="govuk-breadcrumbs" id="breadcrumbs">
        <ol class="govuk-breadcrumbs__list">
            <li class="govuk-breadcrumbs__list-item">
                <a class="govuk-breadcrumbs__link" th:href="@{'/admin/silas-administration/delete-role'}">< Back</a>
            </li>
        </ol>
    </nav>
    
    <main class="govuk-main-wrapper" id="main-content">
        <div class="govuk-grid-row">
            <div class="govuk-grid-column-full">
                
                <div th:if="${errorMessage}" class="govuk-error-summary" role="alert" aria-labelledby="error-summary-title" tabindex="-1" data-module="govuk-error-summary">
                    <h2 class="govuk-error-summary__title" id="error-summary-title">
                        There is a problem
                    </h2>
                    <div class="govuk-error-summary__body">
                        <ul class="govuk-list govuk-error-summary__list">
                            <li>
                                <a href="#reason-error" th:text="${errorMessage}"></a>
                            </li>
                        </ul>
                    </div>
                </div>

                <h1 class="govuk-heading-l" th:text="'Are you sure you want to delete the ' + ${roleName} + ' role?'">
                    Are you sure you want to delete the [Role name] role?
                </h1>

                <p class="govuk-hint">
                    Deleting a role is a permanent and destructive action that cannot be undone. Once confirmed, the
                    role will be completely removed from SiLAS and revoked from all users who currently have it, which
                    means any permissions or access tied to this role will be lost immediately.
                </p>

                <p class="govuk-hint">
                    This change will impact user assignments across multiple firms, potentially disrupting workflows,
                    access rights, and compliance requirements.
                </p>

                <div class="govuk-warning-text">
                    <span class="govuk-warning-text__icon" aria-hidden="true">!</span>
                    <strong class="govuk-warning-text__text">
                        <span class="govuk-visually-hidden">Warning</span>
                        Proceed only if you are certain this role is no longer needed, as recovery will require manual
                        reconfiguration and reassignment of permissions.
                    </strong>
                </div>

                <form method="post" th:action="@{'/admin/silas-administration/delete-role/' + ${roleId} + '/reason'}" th:object="${deleteAppRoleReasonForm}">
                    
                    <!-- Hidden field to carry forward the selected firm -->
                    <input type="hidden" name="appName" th:field="*{appName}" />
                    <input type="hidden" name="appRoleId" th:field="*{appRoleId}" />
                    
                    <!-- Reason Field -->
                    <div class="govuk-form-group govuk-!-width-two-thirds" th:classappend="${#fields.hasErrors('reason')} ? 'govuk-form-group--error' : ''" id="reason-group">
                        <div th:if="${#fields.hasErrors('reason')}" class="govuk-error-message" id="reason-error">
                            <span class="govuk-visually-hidden">Error:</span>
                            <span th:errors="*{reason}"></span>
                        </div>

                        <label class="govuk-label govuk-label--m" for="reassignment-reason">
                            Please enter a reason (minimum 10 characters).
                        </label>
                        
                        <textarea class="govuk-textarea" 
                                  th:classappend="${#fields.hasErrors('reason')} ? 'govuk-textarea--error' : ''"
                                  id="reassignment-reason" 
                                  name="reason" 
                                  rows="8"
                                  th:field="*{reason}"></textarea>
                    </div>
                    
                    <div class="govuk-button-group">
                        <button type="submit" class="govuk-button govuk-button--warning" data-module="govuk-button">
                            Confirm and Continue
                        </button>
                        <a class="govuk-link" th:href="@{'/admin/silas-administration/delete-role'}">Cancel</a>
                    </div>
                </form>
            </div>
        </div>
    </main>
</body>

</html>
